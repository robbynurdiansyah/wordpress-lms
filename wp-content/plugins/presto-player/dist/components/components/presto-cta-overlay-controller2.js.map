{"file":"presto-cta-overlay-controller2.js","mappings":"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","names":["__stencil_proxyCustomElement"],"sources":["src/components/core/features/presto-cta-overlay/controller/presto-cta-overlay-controller.css?tag=presto-cta-overlay-controller","src/components/core/features/presto-cta-overlay/controller/presto-cta-overlay-controller.tsx"],"sourcesContent":[":host {\n  display: block;\n}\n","import { Component, Event, EventEmitter, h, Prop, State, Watch } from '@stencil/core';\nimport { i18nConfig, CTA } from '../../../../../interfaces';\nimport { timePassed } from '../../../../../util';\n\n@Component({\n  tag: 'presto-cta-overlay-controller',\n  styleUrl: 'presto-cta-overlay-controller.css',\n  shadow: false,\n})\nexport class PrestoCtaOverlayController {\n  @Prop() ended: boolean;\n  @Prop({ reflect: true }) currentTime: number;\n  @Prop({ reflect: true }) duration: number;\n  @Prop() direction?: 'rtl';\n  @Prop() cta?: CTA;\n  @Prop() i18n: i18nConfig;\n  @Prop() provider: string;\n\n  @State() enabled: boolean;\n  @State() show: boolean;\n  @State() loading: boolean;\n  @State() error: string;\n  @State() skipped: boolean;\n  @State() percentagePassed: number = 0;\n\n  @Event() playVideo: EventEmitter<void>;\n  @Event() pauseVideo: EventEmitter<boolean>;\n  @Event() restartVideo: EventEmitter<void>;\n  @Event() ctaStateChange: EventEmitter<boolean>;\n\n  componentWillLoad() {\n    this.handleDuration();\n  }\n\n  /**\n   * Handle with the player is ended\n   * @param val\n   * @returns\n   */\n  @Watch('ended')\n  handleEnded(val) {\n    if (val) {\n      if (this?.cta?.percentage !== 100) return;\n      this.show = true;\n    }\n  }\n\n  /**\n   * Wait for duration to start before checking time\n   * @returns void\n   */\n  @Watch('duration')\n  handleDuration() {\n    this.enabled = this.skipped ? false : this?.cta?.enabled;\n    this.handleTime();\n  }\n\n  @Watch('currentTime')\n  @Watch('duration')\n  handlePercentagePassed() {\n    this.percentagePassed = (this.currentTime / this.duration) * 100;\n  }\n\n  /**\n   * Watch current time and check if we should\n   * pause the video.\n   */\n  @Watch('currentTime')\n  handleEnabled() {\n    if (!this.show) return; // not showing.\n    if (this.skipped) return; // already skipped.\n    this.pauseVideo.emit(true); // pause if enabled.\n  }\n\n  /**\n   * When current time changes, check to see if we should\n   * enable the overlay\n   * @returns void\n   */\n  @Watch('currentTime')\n  handleTime() {\n    if (!this.enabled) return; // not enabled.\n    if (this.skipped) return; // skipped.\n    if (this?.cta?.percentage === 100) return; // we'll catch this on ended event.\n    this.checkTime();\n  }\n\n  /**\n   * Set enabled/disabled based on time that has passed\n   */\n  checkTime() {\n    this.show = timePassed({\n      current: this.currentTime,\n      duration: this.duration,\n      showAfter: this?.cta?.percentage || 0,\n    });\n  }\n\n  /**\n   * Skip email collection\n   */\n  skip() {\n    this.skipped = true;\n    this.show = false;\n    this.playVideo.emit();\n  }\n\n  /**\n   * Handle rewatch click.\n   */\n  rewatch() {\n    this.ended = false;\n    this.show = false;\n    this.restartVideo.emit();\n  }\n\n  /**\n   * Maybe render\n   * @returns JSX\n   */\n\n  @Watch('show')\n  handleCtaStateChange(val) {\n    this.ctaStateChange.emit(val);\n  }\n  render() {\n    if (!this.show) {\n      return;\n    }\n\n    return (\n      <presto-cta-overlay-ui\n        style={{\n          '--presto-player-button-border-radius': `${this?.cta?.button_radius}px`,\n          ...(this?.cta?.background_opacity ? { '--presto-player-cta-background-opacity': `${this?.cta?.background_opacity / 100}` } : {}),\n          ...(this?.cta?.button_color\n            ? {\n                '--presto-player-button-color': `${this?.cta?.button_color}`,\n              }\n            : {}),\n          ...(this?.cta?.button_text_color\n            ? {\n                '--presto-player-button-text': `${this?.cta?.button_text_color}`,\n              }\n            : {}),\n        }}\n        direction={this.direction}\n        class=\"cta-overlay\"\n        i18n={this.i18n}\n        headline={this?.cta?.headline}\n        bottom-text={this?.cta?.bottom_text}\n        show-button={this?.cta?.show_button}\n        buttonLink={this?.cta?.button_link}\n        allowSkip={!this.ended && this?.cta?.show_skip}\n        allowRewatch={this.ended && this?.cta?.show_rewatch}\n        button-text={this?.cta?.button_text}\n        onSkip={() => this.skip()}\n        onRewatch={() => this.rewatch()}\n        provider={this.provider}\n      ></presto-cta-overlay-ui>\n    );\n  }\n}\n"],"version":3}